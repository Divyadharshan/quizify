<div id="universal-loader" class="loader-overlay">
    <div class="loader-content">
        <img src="/logo.png" alt="Quizify Logo" class="loader-logo">
        <div class="loader-spinner"></div>
        <p class="loader-text">Loading...</p>
    </div>
</div>

<style>
.loader-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 0.5s ease-out;
}

.loader-content {
    text-align: center;
    color: #7B16FF;
}

.loader-logo {
    width: 200px;
    height: 200px;
    margin-bottom: 20px;
    animation: pulse 2s infinite;
}

.loader-spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #7B16FF;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
    margin: 20px auto;
}

.loader-text {
    font-size: 18px;
    font-weight: bold;
    margin-top: 15px;
    font-family: Arial, sans-serif;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.loader-hidden {
    opacity: 0;
    pointer-events: none;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const loader = document.getElementById('universal-loader');
    let isNavigating = false;
    let navigationTimeout;
    function hideLoader() {
        if (loader && !isNavigating) {
            loader.classList.add('loader-hidden');
            setTimeout(function() {
                if (!isNavigating) {
                    loader.style.display = 'none';
                }
            }, 500);
        }
    }
    function showLoader() {
        if (loader) {
            isNavigating = true;
            loader.classList.remove('loader-hidden');
            loader.style.display = 'flex';
        }
    }
    
    window.addEventListener('load', function() {
        setTimeout(function() {
            isNavigating = false;
            hideLoader();
        }, 1000);
    });
    window.addEventListener('pageshow', function() {
        isNavigating = false;
        hideLoader();
    });
    
    window.addEventListener('popstate', function() {
        isNavigating = false;
        hideLoader();
    });
    
    document.addEventListener('visibilitychange', function() {
        if (!document.hidden && !isNavigating) {
            hideLoader();
        }
    });
    
    window.addEventListener('beforeunload', function() {
        isNavigating = true;
    });
    
    document.addEventListener('click', function(e) {
        const link = e.target.closest('a');
        if (link && link.href && !link.href.startsWith('javascript:') && !link.href.startsWith('#')) {
            try {
                const url = new URL(link.href);
                if (url.origin === window.location.origin) {
                    showLoader();
                }
            } catch (e) {
                showLoader();
            }
        }
    });
    document.addEventListener('submit', function(e) {
        showLoader();
    });

    if (window.history && window.history.pushState) {
        const originalPushState = window.history.pushState;
        window.history.pushState = function() {
            originalPushState.apply(this, arguments);
            isNavigating = false;
            hideLoader();
        };
    }
    
    setTimeout(function() {
        if (loader && loader.style.display !== 'none') {
            isNavigating = false;
            hideLoader();
        }
    }, 5000);
});
</script> 